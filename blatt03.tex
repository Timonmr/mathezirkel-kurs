\documentclass{zirkelblatt}
\usepackage{young}
\geometry{tmargin=2cm,bmargin=3cm,lmargin=3cm,rmargin=3cm}
\usepackage{lscape}
\newcommand{\head}[1]{\section*{\rmfamily #1}}%begin{center}\large \textbf{#1}\end{center}}
\let\raggedsection\centering
\newcommand{\fuzzy}{\mathrel{||}}
\newcommand{\ol}[1]{\ensuremath{\overline{#1}}}
\newcommand{\ZZ}{\mathbb{Z}}

%\setkeys{Gin}{draft}
\begin{document}

\maketitle{Klasse 11./12., Gruppe 2}{\\ 15. März 2014 und 29. März 2014}

% Konventionen: ganze Zahlen
% teilerfremd <==> ggT=1.
% 0 teilerfremd

\head{Zahlentheoretische Grundlagen}

Ein \emph{Ring} ist eine algebraische Struktur mit einer Addition und
Multiplikation, die mit der gewöhnlichen Addition und Multiplikation von ganzen
Zahlen zu tun haben können, aber nicht unbedingt müssen. Von einem Ring fordert
man die folgenden Axiome:
\begin{align*}
    0 + x &= x = x + 0 \\
    x + y &= y + x \\
    x + (y + z) &= (x + y) + z \\\\
    1 \cdot x &= x = x \cdot 1 \\
    x \cdot y &= y \cdot x \\
    x \cdot (y \cdot z) &= (x \cdot y) \cdot z \\\\
    x \cdot (y + z) &= x \cdot y + x \cdot z \\
    (x + y) \cdot z &= x \cdot z + y \cdot z
\end{align*}
Dabei bezeichnen die Symbole~"`$0$"' und~"`$1$"' zwei besondere Elemente des
Rings, nicht unbedingt die bekannten Zahlen Null und Eins. Man nennt sie wegen
ihrer besonderen Bedeutung \emph{Null-} und \emph{Einselement}. Ein weiteres
Axiom besagt, dass es zu jedem Element~$x$ ein weiteres Element geben soll,
bezeichnet~$-x$, das bezüglich der Addition invers zu $x$ ist:
\[ x + (-x) = 0 = (-x) + x. \]
Weitere Axiome fordert man von Ringen nicht.
\vspace{\aufgabenskip}

\begin{aufgabe}{Beispiele und Nichtbeispiele für Ringe}
Mache dir klar:
\begin{enumerate}
\item Die rationalen Zahlen bilden bezüglich der gewöhnlichen
Addition und Multiplikation einen Ring.
\item Die ganzen Zahlen bilden bezüglich der gewöhnlichen
Addition und Multiplikation einen Ring.
\item Die natürlichen Zahlen bilden bezüglich der gewöhnlichen Addition und
Multiplikation \emph{keinen} Ring.
\item Die ganzen Zahlen bilden \emph{keinen} Ring, wenn man als Addition
paradoxerweise die Subtraktion und als Multiplikation die übliche
Multiplikation nimmt.
\end{enumerate}
Für die Kryptographie gehören die \emph{Restklassenringe} zu den wichtigsten
Ringen.
\end{aufgabe}

\newpage
\begin{aufgabe}{Restklassenarithmetik}
Sei~$m$ eine feste positive Zahl. Dann besteht der
\emph{Restklassenring}~$\ZZ/(m)$ (oft auch~"`$\ZZ_m$"' geschrieben) aus den
verschiedenen Resten, die bei Division durch~$m$ auftreten können:
\[ \ZZ/(m) = \{ \ol{0}, \ol{1}, \ol{2}, \ldots, \ol{m-1} \}. \]
Wenn man faul ist, lässt man die Oberstriche auch weg. In~$\ZZ/(m)$ addiert und
multipliziert man fast wie gewohnt -- nur dass man nach jedem Rechenschritt die
Ergebnisse \emph{modulo~$m$} vereinfachen kann.
\begin{enumerate}
\item Überzeuge dich davon, dass in~$\ZZ/(6)$ folgende Rechnung stimmt:
\[ \ol{4} + \ol{7} = \ol{11} = \ol{5}. \]
\item Ergänze unten stehende Tabellen für die Addition und Multiplikation
in~$\ZZ/(4)$.
\item Ein Element~$x$ eines Rings heißt genau dann \emph{invertierbar}, wenn es
ein weiteres Element~$y$ mit der Eigenschaft~$xy = 1$ gibt. Das Element~$y$
heißt dann auch \emph{Inverses} von~$x$. Welche Elemente von~$\ZZ/(4)$ sind
invertierbar?
\end{enumerate}
\begin{center}
  \begin{tabular}{r|cccc}
    $+$    & \ol{0} & \ol{1} & \ol{2} & \ol{3} \\\hline
    \ol{0} & \ol{0} & \ol{1} & \ol{2} \\
    \ol{1} &   &        &        \\
    \ol{2} & \\
    \ol{3} & & & \ol{1}
  \end{tabular}
  \qquad
  \begin{tabular}{r|cccc}
    $\cdot$ & \ol{0} & \ol{1} & \ol{2} & \ol{3} \\\hline
    \ol{0} & \ol{0} & \ol{0} & \ol{0} \\
    \ol{1} &   &        &        \\
    \ol{2} & \\
    \ol{3} & & & \ol{2}
  \end{tabular}
\end{center}
\end{aufgabe}

\begin{aufgabe}{Falsche binomische Formel}
Für ganze Zahlen~$x,y$ gilt bekanntermaßen die \emph{binomische Formel}:
\[ (x+y)^2 = x^2 + 2xy + y^2. \]
\begin{enumerate}
\item Beweise diese Formel rechnerisch.
\item Gib einen geometrischen Beweis, der etwas mit Quadraten der
Seitenlängen~$x$ und~$y$ zu tun hat.
\item Beweise, dass die binomische Formel sogar in jedem Ring gilt. Dabei ist allgemein~"`$a^2$"'
eine Abkürzung für~$a \cdot a$ und~"`$2$"' eine Abkürzung für~$1 + 1$ (was auch
immer das in dem untersuchten Ring ergeben mag).
\item Beweise, dass im Ring~$\ZZ/(2)$ außerdem die sogenannte
\emph{falsche binomische Formel} gilt:
\[ (x+y)^2 = x^2 + y^2. \]
\item Wenn du aus der Informatik die logischen Gatter (wie UND, ODER, \ldots)
kennst, interessiert dich vielleicht folgende Frage: Was haben die Addition und
die Multiplikation von~$\ZZ/(2)$ mit den logischen Gattern zu tun?
\end{enumerate}
\end{aufgabe}

\newpage
\begin{aufgabe}{Euklidischer Algorithmus}
Eines der ältesten überlieferten numerischen Verfahren ist der
\emph{euklidische Algorithmus}. Mit seiner Hilfe kann man auf effiziente Art und Weise
den größten gemeinsamen Teiler zweier ganzer Zahlen bestimmen -- viel
schneller, als wenn man erst die Zahlen in Primfaktoren zerlegen würde.
\begin{align*}
    42 &= 1 \cdot 26 + 16 \\
    26 &= 1 \cdot 16 + 10 \\
    16 &= 1 \cdot 10 + 6 \\
    10 &= 1 \cdot 6 + 4 \\
    6 &= 1 \cdot 4 + 2 \\
    4 &= 2 \cdot 2 + 0
\end{align*}
\begin{enumerate}
\item In diesem Beispiel wurde der euklidische Algorithmus verwendet, um den
größten gemeinsamen Teiler von~$42$ und~$26$ zu ermitteln (dieser ist~$2$).
Erschließe, wie das Verfahren funktioniert.
\item Bestimme mit dem euklidischen Algorithmus den größten gemeinsamen Teiler
zweier Zahlen deiner Wahl.
\item Das Verfahren hört dann auf, wenn als Rest~$0$ auftritt. Erkläre, wieso
das unabhängig von den Anfangszahlen stets nach endlich vielen Schritten der
Fall ist! (Man sagt, dass der euklidische Algorithmus \emph{terminiert}.)
\item Mit dem Algorithmus kann man durch \emph{Rückwärtsauflösen} den größten
gemeinsamen Teiler~$d$ zweier ganzer Zahlen~$x$ und~$y$ in der Form~$d = ax +
by$ für gewisse Hilfszahlen~$a$ und~$b$ schreiben. Versuche das in obigem
Beispiel!
\end{enumerate}
Eine Darstellung der Form~$d = ax + by$ des größten gemeinsamen Teilers heißt
auch \emph{Bézoutdarstellung}. Es ist etwas sehr besonderes, dass es im Ring
der ganzen Zahlen eine solche immer gibt.
\end{aufgabe}

\begin{aufgabe}{Invertierbarkeit in Restklassenringen}
In den Restklassenringen ist nicht jedes Element invertierbar, das haben wir
schon beim Beispiel mit~$\ZZ/(4)$ gesehen. Es gilt folgende Regel: Ein
Element~$\ol{a}$ von~$\ZZ/(m)$ ist genau dann invertierbar, wenn die Zahlen~$a$
und~$m$ zueinander teilerfremd sind.
\begin{enumerate}
\item Bestätige diese Regel im Beispiel~$\ZZ/(4)$.
\item Erkläre, wie man den euklidischen Algorithmus verwenden kann, um
in~$\ZZ/(m)$ Inverse zu berechnen!
\item Welche Elemente sind in~$\ZZ/(p)$ invertierbar, wenn~$p$ eine Primzahl
ist?
\end{enumerate}
\end{aufgabe}

\newpage
\begin{aufgabe}{Eulersche Phi-Funktion}
Die Anzahl der in~$\ZZ/(m)$ invertierbaren Elemente schreibt man
auch~"`$\Phi(m)$"'. Sei im Folgenden~$p$ eine beliebige Primzahl.
\begin{enumerate}
\item Zeige: $\Phi(p) = p - 1$.
\item Zeige: $\Phi(p^2) = p^2 - p$.
\item Was ist~$\Phi(p^3)$?
\item Was ist~$\Phi(p^n)$?
\end{enumerate}
Später werden wir verstehen, dass für teilerfremde Zahlen~$a,b$ die Rechenregel
\[ \Phi(ab) = \Phi(a) \cdot \Phi(b) \]
gilt. Damit kann man die Werte der eulerschen Phi-Funktion recht effizient
berechnen.
\end{aufgabe}


\head{Kryptographische Verfahren}

\begin{aufgabe}{Eine Analogie für symmetrische Verschlüsselung}
Alice möchte Bob ein Paket per Post schicken, sie misstraut aber dem
Postsystem. Daher versieht sie das Paket mit einem Vorhängeschloss, zu dem
Alice und Bob beide Schlüssel besitzen.
\begin{enumerate}
\item Gegen welche Angriffe schützt dieses Verfahren?
\item Wo liegen seine Nachteile?
\item Was passiert, wenn Alice und Bob auf diese Weise weiter kommunizieren,
Bob aber auf seinen Schlüssel nicht gut aufpasst?
\item Welche Nachteile treten auf, wenn mehrere Freunde mit diesem Verfahren
sicher kommunizieren möchten?
\end{enumerate}
\end{aufgabe}

\begin{aufgabe}{Eine Analogie für asymmetrische Verschlüsselung}
Alice möchte wieder Bob ein Paket per Post schicken. Dazu versieht sie diesmal
das Paket mit einem Vorhängeschloss, zu dem nur Bob den Schlüssel hat.
\begin{enumerate}
\item Gegen welche Angriffe schützt dieses Verfahren?
\item Welchen fundamentalen Vorteil hat dieses Verfahren gegenüber symmetrischer
Verschlüsselung?
\item Wo liegen seine Nachteile?
\end{enumerate}
\end{aufgabe}

\begin{aufgabe}{Eine Analogie für ein Drei-Durchgänge-Protokoll}
Alice möchte abermals Bob ein Paket per Post schicken. Sie haben jedoch vorher
keinerlei Schlösser oder Schlüssel ausgetauscht.
\begin{enumerate}
\item Überlege dir ein dreischrittiges Verfahren, das in diesem Fall angewendet
werden kann!
\item Gegen welche Angriffe ist es sicher, gegen welche nicht?
\end{enumerate}
\end{aufgabe}

\begin{aufgabe}{Ein unsicheres Drei-Durchgänge-Protokoll: XOR}
Sind~$m_1$ und~$m_2$ zwei gleich lange Texte, so wollen wir mit~"`$m_1 \oplus
m_2$"' denjenigen Text bezeichnen, den man erhält, wenn man von den einzelnen (ASCII-
oder UTF-8-)Zeichen bitweise das \emph{exklusive Oder} (XOR) nimmt. Ein
Beispiel:
\begin{verbatim}
    Text 1: "abc", in Bits: 01100001 01100010 01100011
    Text 2: "0AZ", in Bits: 00110000 01000001 01011010
    XOR:    "Q#9", in Bits: 01010001 00100011 00111001
\end{verbatim}
\begin{enumerate}
\item Erkläre, wie die XOR-Verknüpfung funktioniert!
\end{enumerate}
Alice möchte an Bob einen Text~$m$ schicken. Alice und Bob haben vorher nie
miteinander kommuniziert und insbesondere keine gemeinsamen Schlüssel
ausgemacht. Mit der XOR-Verknüpfung kann man trotzdem ein geeignetes
kryptographisches Verfahren beschreiben:
\begin{shaded}
\begin{enumerate}
\item[1.] Alice generiert einen zufälligen Schlüssel~$s_1$, der genau so lang
ist wie~$m$. Sie schickt über eine unsichere Leitung an Bob die kodierte
Nachricht~$c := m \oplus s_1$.
\item[2.] Bob generiert seinerseits einen zufälligen Schlüssel~$s_2$ gleicher
Länge. Er schickt über eine unsichere Leitung an Alice die Nachricht~$c' := c
\oplus s_2$.
\item[3.] Alice übermittelt~$c'' := c' \oplus s_1$ an Bob. Dann ist~$c'' \oplus
s_2$ gleich~$m$, Bob kann also die geheime Nachricht lesen.
\end{enumerate}
\end{shaded}
\begin{enumerate}
\addtocounter{enumi}{1}
\item Erkläre, wieso das Verfahren überhaupt funktioniert, wieso also~$c''
\oplus s_2 = m$ gilt.
\item Das Verfahren hat eine große Schwachstelle: Ein Mithörer kann sich
ebenfalls den Inhalt von~$m$ erschließen. Erkläre, wie das geht!
\item Welche weiteren Nachteile hat das Verfahren?
\end{enumerate}
\end{aufgabe}

\begin{aufgabe}{Das RSA-Verfahren}
Das RSA-Verfahren ist eines der bekanntesten asymmetrischen
Verschlüsselungsverfahren. Die Originalvariante ist unsicher, aber leichte
Verbesserungen gelten als sicher -- zumindest werden sie weltweit täglich
eingesetzt.

\begin{shaded}
\textbf{Schlüsselpaarerzeugung.} Wähle zufällig zwei verschiedene Primzahlen~$p$ und~$q$ und
berechne ihr Produkt: $m := p q$ (der \emph{Modulus}). Wähle zufällig eine
zu~$(p-1) \cdot (q-1)$ teilerfremde Zahl~$e$. Berechne eine Zahl~$d$,
sodass~$\ol{d}$ im Restklassenring~$\ZZ/((p-1)(q-1))$ invers zu~$\ol{e}$ ist.

Die Zahlen~$e$ und~$m$ bilden dann gemeinsam den \emph{öffentlichen Schlüssel},
die Zahlen~$d$ und~$m$ den \emph{privaten Schlüssel}.

\textbf{Verschlüsselung.} Die Verschlüsselung einer Nachricht~$k$ (die als Zahl
ausgedrückt sein muss) ist die Restklasse~$c := \ol{k}^e \in \ZZ/(m)$.

\textbf{Entschlüsselung.} Die Entschlüsselung eines Chiffrats~$c$ ist die
Restklasse~$c^d \in \ZZ/(m)$.
\end{shaded}

\begin{enumerate}
\item Wie kann man beim Schlüsselpaarerzeugungsschritt die Zahl~$d$ bestimmen?
Wieso ist das immer möglich?
\item Wie kann man eine zu verschlüsselnde Nachricht als Zahl darstellen? Wieso
muss man darauf achten, dass die resultierende Zahl kleiner als~$m$ ist? Was
kann man machen, wenn die Zahl leider doch größer oder gleich~$m$ ist?
\item Beweise, dass das Verfahren funktioniert -- beweise also, dass die
Entschlüsselung der Verschlüsselung einer Restklasse~$k \in \ZZ/(m)$ wieder
dieselbe Restklasse~$k$ ergibt.

Verwende dazu den \emph{Satz von Euler}: Sind~$a$ und~$m$ teilerfremde Zahlen,
so gilt~$\ol{a}^{\Phi(m)} = 1 \in \ZZ/(m)$. (Vielleicht beweisen wir diesen
Satz später noch.) Zur Vereinfachung kannst du in deinem Beweis annehmen,
dass~$k$ zu~$m$ teilerfremd ist.
\item Worauf basiert die Sicherheit des Verfahrens? Was müsste man können, um
ohne Kenntnis des privaten Schlüssels aus einem Chiffrat~$k^e$ auf den
Klartext~$k$ schließen zu können?
\item Wenn der öffentliche Schlüssel~$e$ und der Zahlenwert des Klartextes~$k$
"`klein"' sind, ist das Verfahren unsicher. Begründe das!
\item Wenn~$m$ klein ist (etwa kleiner oder gleich der Anzahl der verschiedenen
denkbaren Buchstaben), degradiert das RSA-Verfahren zu einer monoalphabetischen
Verschlüsselung. Begründe das!
\end{enumerate}
\end{aufgabe}


\end{document}

Chinesischer Restsatz?

Unendliche Kettenbrüche! Lenken etwas vom Kernthema ab, sind aber nur leicht
entfernt vom euklidischen Algorithmus und sicherlich sehr cool!
http://topologicalmusings.wordpress.com/2008/08/04/continued-fraction-for-e/
